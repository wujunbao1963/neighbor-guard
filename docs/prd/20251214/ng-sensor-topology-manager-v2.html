<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NG Edge Console v2 - Sensor & Topology Manager</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #667eea;
            --success: #51cf66;
            --warning: #fab005;
            --danger: #fa5252;
            --info: #339af0;
            --bg-light: #f8f9fa;
            --text-primary: #212529;
            --text-secondary: #868e96;
            --border: #e9ecef;
        }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 32px;
        }
        .header h1 { font-size: 32px; font-weight: 800; }
        .tabs {
            display: flex;
            background: var(--bg-light);
            border-bottom: 2px solid var(--border);
            padding: 0 32px;
            overflow-x: auto;
        }
        .tab {
            padding: 18px 28px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            font-weight: 600;
            color: var(--text-secondary);
            transition: all 0.2s;
            white-space: nowrap;
        }
        .tab:hover { color: var(--primary); background: white; }
        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: white;
        }
        .content { padding: 40px; min-height: 600px; }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .btn {
            padding: 12px 24px;
            border: none;
            background: var(--primary);
            color: white;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        .btn:hover { background: #5568d3; transform: translateY(-2px); }
        .btn-secondary {
            background: var(--bg-light);
            color: var(--text-primary);
            border: 2px solid var(--border);
        }
        .btn-secondary:hover { background: #e9ecef; }
        .sensor-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin-top: 24px;
        }
        .sensor-card {
            background: white;
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            transition: all 0.2s;
        }
        .sensor-card:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(102,126,234,0.15);
            transform: translateY(-4px);
        }
        .topology-canvas {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 40px;
            min-height: 500px;
        }
        .entry-point {
            background: white;
            border: 3px solid var(--danger);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            transition: all 0.2s;
        }
        .entry-point:hover {
            transform: scale(1.01);
            box-shadow: 0 8px 24px rgba(250,82,82,0.15);
        }
        .sensor-path {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 12px 0;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid var(--border);
        }
        .add-sensor-btn {
            width: 100%;
            padding: 16px;
            border: 2px dashed var(--primary);
            background: white;
            color: var(--primary);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
            margin-top: 16px;
        }
        .add-sensor-btn:hover {
            background: var(--primary);
            color: white;
            border-style: solid;
        }
        .param-group {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ›¡ï¸ NG Edge Console v2 - ä¼ æ„Ÿå™¨ä¸æ‹“æ‰‘ç®¡ç†</h1>
            <p style="margin-top: 8px; opacity: 0.9;">å®Œæ•´çš„ä¼ æ„Ÿå™¨ç®¡ç†å’Œå¯è§†åŒ–æ‹“æ‰‘æ„å»ºå™¨</p>
        </div>
        
        <div class="tabs">
            <div class="tab active">ğŸ“¡ ä¼ æ„Ÿå™¨ç®¡ç†</div>
            <div class="tab">ğŸ—ºï¸ æ‹“æ‰‘æ„å»ºå™¨</div>
            <div class="tab">âš™ï¸ æ£€æµ‹å‚æ•°</div>
        </div>
        
        <div class="content">
            <!-- ä¼ æ„Ÿå™¨ç®¡ç†é¡µé¢ -->
            <div class="page active">
                <h2 style="font-size: 28px; font-weight: 700; margin-bottom: 12px;">ä¼ æ„Ÿå™¨ç®¡ç†</h2>
                <p style="color: var(--text-secondary); margin-bottom: 32px;">æ·»åŠ ã€åˆ é™¤å’Œç»´æŠ¤æ‰€æœ‰ä¼ æ„Ÿå™¨ä¸æ‘„åƒå¤´</p>
                
                <div style="display: flex; gap: 12px; margin-bottom: 24px;">
                    <button class="btn" id="addSensorBtn">â• æ·»åŠ æ–°ä¼ æ„Ÿå™¨</button>
                    <button class="btn btn-secondary">ğŸ“¥ ä»æ–‡ä»¶å¯¼å…¥</button>
                    <button class="btn btn-secondary">ğŸ“¤ å¯¼å‡ºé…ç½®</button>
                </div>
                
                <h3 style="font-size: 20px; font-weight: 700; margin-bottom: 16px; color: var(--text-primary);">è¾“å…¥è®¾å¤‡ï¼ˆä¼ æ„Ÿå™¨ï¼‰</h3>
                <div class="sensor-grid" id="sensorGrid"></div>
                
                <!-- è¾“å‡ºè®¾å¤‡éƒ¨åˆ† -->
                <h3 style="font-size: 20px; font-weight: 700; margin: 40px 0 16px 0; color: var(--text-primary);">è¾“å‡ºè®¾å¤‡ï¼ˆæŠ¥è­¦æ‰§è¡Œå™¨ï¼‰</h3>
                <p style="color: var(--text-secondary); margin-bottom: 24px;">å£°å…‰æŠ¥è­¦å™¨ã€è­¦ç¬›ã€é—ªå…‰ç¯ç­‰æ‰§è¡Œè®¾å¤‡</p>
                
                <div style="margin-bottom: 24px;">
                    <button class="btn" id="addOutputBtn">â• æ·»åŠ æŠ¥è­¦è¾“å‡ºè®¾å¤‡</button>
                </div>
                
                <div class="sensor-grid" id="outputGrid"></div>
            </div>
            
            <!-- æ‹“æ‰‘æ„å»ºå™¨é¡µé¢ -->
            <div class="page">
                <h2 style="font-size: 28px; font-weight: 700; margin-bottom: 12px;">æ‹“æ‰‘æ„å»ºå™¨</h2>
                <p style="color: var(--text-secondary); margin-bottom: 32px;">é€šè¿‡å®šä¹‰å…¥å£ç‚¹å’Œä¼ æ„Ÿå™¨è·¯å¾„æ¥æ„å»ºå®‰é˜²æ‹“æ‰‘</p>
                
                <div style="background: #fff3bf; padding: 20px; border-radius: 12px; margin-bottom: 24px; border-left: 4px solid var(--warning);">
                    <strong>ğŸ’¡ ä½¿ç”¨æ–¹æ³•ï¼š</strong>
                    <ol style="margin-left: 24px; margin-top: 8px; line-height: 1.8;">
                        <li>ç‚¹å‡»"æ·»åŠ å…¥å£ç‚¹"åˆ›å»ºä¸€ä¸ªé—¨/çª—/è½¦åº“å…¥å£</li>
                        <li>ä¸ºæ¯ä¸ªå…¥å£ç‚¹æ·»åŠ ä¼ æ„Ÿå™¨ï¼Œä»å®¤å¤–åˆ°å®¤å†…æ’åˆ—</li>
                        <li>ç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆäº‹ä»¶æ£€æµ‹è§„åˆ™ï¼ˆå®¤å¤–æ£€æµ‹ â†’ å¼€é—¨ â†’ å®¤å†…è¿åŠ¨ï¼‰</li>
                    </ol>
                </div>
                
                <div style="margin-bottom: 24px; display: flex; gap: 12px;">
                    <button class="btn" id="addEntryPointBtn">ğŸšª æ·»åŠ å…¥å£ç‚¹</button>
                    <button class="btn btn-secondary">ğŸ’¾ ä¿å­˜æ‹“æ‰‘</button>
                    <button class="btn btn-secondary">ğŸ“¤ å¯¼å‡ºJSON</button>
                </div>
                
                <div class="topology-canvas" id="topologyCanvas"></div>
            </div>
            
            <!-- æ£€æµ‹å‚æ•°é¡µé¢ -->
            <div class="page">
                <h2 style="font-size: 28px; font-weight: 700; margin-bottom: 12px;">äº‹ä»¶æ£€æµ‹å‚æ•°</h2>
                <p style="color: var(--text-secondary); margin-bottom: 32px;">é…ç½®ä¿¡å·å¦‚ä½•å…³è”ä»¥é¢„æµ‹äº‹ä»¶</p>
                
                <div class="param-group">
                    <h3 style="font-size: 20px; margin-bottom: 20px; font-weight: 700;">â±ï¸ æ—¶é—´çª—å£</h3>
                    
                    <div style="margin-bottom: 24px;">
                        <label style="display: block; font-weight: 700; margin-bottom: 8px;">
                            T_confirm - è·¯å¾„å®Œæˆçª—å£
                            <span style="font-weight: 400; color: var(--text-secondary); font-size: 13px; margin-left: 8px;">
                                ï¼ˆç­‰å¾…å®Œæ•´ä¿¡å·é“¾çš„æœ€é•¿æ—¶é—´ï¼‰
                            </span>
                        </label>
                        <div style="display: flex; gap: 16px; align-items: center;">
                            <input type="range" min="30" max="120" value="60" id="tConfirmSlider" style="flex: 1; height: 6px;">
                            <input type="number" value="60" id="tConfirmValue" style="width: 80px; padding: 8px; border: 2px solid var(--border); border-radius: 6px; text-align: center; font-weight: 700;">
                            <span style="font-size: 14px; width: 40px;">ç§’</span>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 14px; margin-top: 8px;">
                            â„¹ï¸ ä»å®¤å¤–æ£€æµ‹åˆ°å®¤å†…è¿åŠ¨çš„æœ€å¤§æ—¶é•¿ã€‚ä¾‹å¦‚ï¼šåé™¢æ£€æµ‹åˆ°äºº â†’ 60ç§’å†…å¿…é¡»åˆ°è¾¾å®¤å†…æ‰èƒ½ç¡®è®¤å…¥ä¾µ
                        </p>
                    </div>
                    
                    <div style="margin-bottom: 24px;">
                        <label style="display: block; font-weight: 700; margin-bottom: 8px;">
                            å¾˜å¾Šæ£€æµ‹é˜ˆå€¼
                            <span style="font-weight: 400; color: var(--text-secondary); font-size: 13px; margin-left: 8px;">
                                ï¼ˆåœ¨åŒä¸€åŒºåŸŸåœç•™å¤šä¹…è§¦å‘å¯ç–‘äº‹ä»¶ï¼‰
                            </span>
                        </label>
                        <div style="display: flex; gap: 16px; align-items: center;">
                            <input type="range" min="15" max="120" value="30" id="loiterSlider" style="flex: 1; height: 6px;">
                            <input type="number" value="30" id="loiterValue" style="width: 80px; padding: 8px; border: 2px solid var(--border); border-radius: 6px; text-align: center; font-weight: 700;">
                            <span style="font-size: 14px; width: 40px;">ç§’</span>
                        </div>
                    </div>
                </div>
                
                <div class="param-group">
                    <h3 style="font-size: 20px; margin-bottom: 20px; font-weight: 700;">ğŸšï¸ ç½®ä¿¡åº¦é˜ˆå€¼</h3>
                    
                    <div style="margin-bottom: 24px;">
                        <label style="display: block; font-weight: 700; margin-bottom: 8px;">
                            å€™é€‰ â†’ ç¡®è®¤ é˜ˆå€¼
                            <span style="font-weight: 400; color: var(--text-secondary); font-size: 13px; margin-left: 8px;">
                                ï¼ˆç¡®è®¤äº‹ä»¶æ‰€éœ€çš„æœ€ä½ç½®ä¿¡åº¦ï¼‰
                            </span>
                        </label>
                        <div style="display: flex; gap: 16px; align-items: center;">
                            <input type="range" min="50" max="95" value="70" id="confirmSlider" style="flex: 1; height: 6px;">
                            <input type="number" value="70" id="confirmValue" style="width: 80px; padding: 8px; border: 2px solid var(--border); border-radius: 6px; text-align: center; font-weight: 700;">
                            <span style="font-size: 14px; width: 40px;">%</span>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 14px; margin-top: 8px;">
                            âš–ï¸ æƒè¡¡ï¼šæ›´ä½ = æ›´æ•æ„Ÿï¼Œæ›´å¤šè¯¯æŠ¥ | æ›´é«˜ = æ›´ä¿å®ˆï¼Œå¯èƒ½æ¼æ£€
                        </p>
                    </div>
                    
                    <div style="margin-bottom: 24px;">
                        <label style="display: block; font-weight: 700; margin-bottom: 8px;">
                            ä¿¡å·æœ€ä½ç½®ä¿¡åº¦
                            <span style="font-weight: 400; color: var(--text-secondary); font-size: 13px; margin-left: 8px;">
                                ï¼ˆå¿½ç•¥ä½äºæ­¤å€¼çš„æ£€æµ‹ï¼‰
                            </span>
                        </label>
                        <div style="display: flex; gap: 16px; align-items: center;">
                            <input type="range" min="30" max="90" value="50" id="signalMinSlider" style="flex: 1; height: 6px;">
                            <input type="number" value="50" id="signalMinValue" style="width: 80px; padding: 8px; border: 2px solid var(--border); border-radius: 6px; text-align: center; font-weight: 700;">
                            <span style="font-size: 14px; width: 40px;">%</span>
                        </div>
                    </div>
                </div>
                
                <div class="param-group">
                    <h3 style="font-size: 20px; margin-bottom: 20px; font-weight: 700;">âš–ï¸ è¯„åˆ†æƒé‡</h3>
                    
                    <div style="margin-bottom: 24px;">
                        <label style="display: block; font-weight: 700; margin-bottom: 8px;">
                            å®Œæ•´è·¯å¾„æƒé‡ï¼ˆå®¤å¤– â†’ å¼€é—¨ â†’ å®¤å†…ï¼‰
                        </label>
                        <div style="display: flex; gap: 16px; align-items: center;">
                            <input type="range" min="50" max="100" value="80" id="pathWeightSlider" style="flex: 1; height: 6px;">
                            <input type="number" value="80" id="pathWeightValue" style="width: 80px; padding: 8px; border: 2px solid var(--border); border-radius: 6px; text-align: center; font-weight: 700;">
                            <span style="font-size: 14px; width: 40px;">%</span>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 14px; margin-top: 8px;">
                            æ£€æµ‹åˆ°å®Œæ•´è·¯å¾„çš„åŸºç¡€ç½®ä¿¡åº¦ï¼ˆåŠ æˆå‰ï¼‰
                        </p>
                    </div>
                    
                    <div style="margin-bottom: 24px;">
                        <label style="display: block; font-weight: 700; margin-bottom: 8px;">
                            åŒæ‘„åƒå¤´åŠ æˆ
                        </label>
                        <div style="display: flex; gap: 16px; align-items: center;">
                            <input type="range" min="0" max="30" value="14" id="dualCameraSlider" style="flex: 1; height: 6px;">
                            <input type="number" value="14" id="dualCameraValue" style="width: 80px; padding: 8px; border: 2px solid var(--border); border-radius: 6px; text-align: center; font-weight: 700;">
                            <span style="font-size: 14px; width: 40px;">%</span>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 14px; margin-top: 8px;">
                            å½“2ä¸ªæˆ–æ›´å¤šæ‘„åƒå¤´éƒ½æ£€æµ‹åˆ°äººæ—¶çš„åŠ æˆã€‚ä¾‹å¦‚ï¼šè·¯å¾„80% + åŒæ‘„14% = 94%
                        </p>
                    </div>
                </div>
                
                <button class="btn" style="font-size: 16px;">âœ… åº”ç”¨æ›´æ”¹å¹¶è¿è¡Œæµ‹è¯•</button>
            </div>
        </div>
    </div>
    
    <script>
        // ä¼ æ„Ÿå™¨æ•°æ®
        let sensors = [
            { id: 'cam1', name: 'åé—¨æ‘„åƒå¤´', type: 'camera', zone: 'Z4', status: 'online', ip: '192.168.1.101' },
            { id: 'cam2', name: 'å‰é—¨é—¨é“ƒ', type: 'camera', zone: 'Z1', status: 'online', ip: '192.168.1.102' },
            { id: 'door1', name: 'åé—¨ä¼ æ„Ÿå™¨', type: 'door', zone: 'EP-BACK', status: 'online', protocol: 'Zigbee' },
            { id: 'motion1', name: 'å®¤å†…è¿åŠ¨ä¼ æ„Ÿå™¨', type: 'motion', zone: 'Z7', status: 'online', protocol: 'Zigbee' }
        ];
        
        // è¾“å‡ºè®¾å¤‡æ•°æ®
        let outputs = [
            { 
                id: 'siren1', 
                name: 'å®¤å¤–è­¦ç¬›', 
                type: 'siren', 
                location: 'å‰é—¨å¤–å¢™',
                status: 'online', 
                protocol: 'Zigbee',
                volume: 95,
                modes: ['PENDING', 'TRIGGERED'],
                pattern: 'continuous'
            },
            { 
                id: 'strobe1', 
                name: 'åé™¢é—ªå…‰ç¯', 
                type: 'strobe', 
                location: 'åé™¢å›´æ ',
                status: 'online', 
                protocol: 'WiFi',
                brightness: 100,
                modes: ['PENDING', 'TRIGGERED', 'PRE_INTRUSION'],
                pattern: 'flash_fast'
            },
            { 
                id: 'combo1', 
                name: 'è½¦åº“å£°å…‰æŠ¥è­¦å™¨', 
                type: 'siren_strobe', 
                location: 'è½¦åº“å¤©èŠ±æ¿',
                status: 'online', 
                protocol: 'Zigbee',
                volume: 90,
                brightness: 85,
                modes: ['PENDING', 'TRIGGERED'],
                pattern: 'alternating'
            },
            {
                id: 'chime1',
                name: 'é—¨é“ƒæç¤ºéŸ³',
                type: 'chime',
                location: 'å‰é—¨é—¨é“ƒ',
                status: 'online',
                protocol: 'WiFi',
                volume: 60,
                modes: ['PRE_INTRUSION'],
                pattern: 'gentle_chime'
            }
        ];
        
        // æ‹“æ‰‘æ•°æ®
        let topology = [
            {
                id: 'ep1',
                name: 'EP-FRONT (å‰é—¨)',
                icon: 'ğŸšª',
                sensors: [
                    { name: 'Z1 é—¨é“ƒæ‘„åƒå¤´', type: 'camera', distance: 'é©¬ä¸Šï¼ˆ0mï¼‰' },
                    { name: 'Z2 é—¨å»Šæ‘„åƒå¤´', type: 'camera', distance: 'æ¥è¿‘ï¼ˆ2mï¼‰' },
                    { name: 'å‰é—¨ä¼ æ„Ÿå™¨', type: 'door', distance: 'å…¥å£å¤„' },
                    { name: 'Z6 å®¤å†…èµ°å»Šè¿åŠ¨', type: 'motion', distance: 'å®¤å†…ï¼ˆ3mï¼‰' }
                ]
            },
            {
                id: 'ep2',
                name: 'EP-BACK (åé—¨)',
                icon: 'ğŸšª',
                sensors: [
                    { name: 'Z5 åé™¢æ‘„åƒå¤´', type: 'camera', distance: 'æ¥è¿‘ï¼ˆ5mï¼‰' },
                    { name: 'Z4 åé—¨æ‘„åƒå¤´', type: 'camera', distance: 'é©¬ä¸Šï¼ˆ0mï¼‰' },
                    { name: 'åé—¨ä¼ æ„Ÿå™¨', type: 'door', distance: 'å…¥å£å¤„' },
                    { name: 'Z7 åèµ°å»Šè¿åŠ¨', type: 'motion', distance: 'å®¤å†…ï¼ˆ2mï¼‰' }
                ]
            }
        ];
        
        // æ¸²æŸ“ä¼ æ„Ÿå™¨
        function renderSensors() {
            const grid = document.getElementById('sensorGrid');
            const icons = { camera: 'ğŸ“¹', door: 'ğŸšª', motion: 'ğŸ‘ï¸', window: 'ğŸªŸ' };
            
            grid.innerHTML = sensors.map(s => `
                <div class="sensor-card">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 16px;">
                        <div style="font-size: 32px;">${icons[s.type] || 'ğŸ“¡'}</div>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: ${s.status === 'online' ? '#51cf66' : '#fa5252'};"></div>
                    </div>
                    <div style="font-size: 18px; font-weight: 700; margin-bottom: 4px;">${s.name}</div>
                    <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 16px;">
                        ${s.type === 'camera' ? 'RTSP' : s.protocol} â€¢ Zone: ${s.zone}
                        ${s.ip ? '<br>' + s.ip : ''}
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn" style="flex: 1; font-size: 13px; padding: 8px;" onclick="editSensor('${s.id}')">âš™ï¸ ç¼–è¾‘</button>
                        <button class="btn btn-secondary" style="flex: 1; font-size: 13px; padding: 8px;" onclick="removeSensor('${s.id}')">ğŸ—‘ï¸ åˆ é™¤</button>
                    </div>
                </div>
            `).join('');
        }
        
        // æ¸²æŸ“è¾“å‡ºè®¾å¤‡
        function renderOutputs() {
            const grid = document.getElementById('outputGrid');
            const icons = { 
                siren: 'ğŸ”Š', 
                strobe: 'ğŸ’¡', 
                siren_strobe: 'ğŸš¨',
                chime: 'ğŸ””'
            };
            
            const typeNames = {
                siren: 'è­¦ç¬›',
                strobe: 'é—ªå…‰ç¯',
                siren_strobe: 'å£°å…‰æŠ¥è­¦å™¨',
                chime: 'æç¤ºéŸ³'
            };
            
            grid.innerHTML = outputs.map(o => `
                <div class="sensor-card" style="border-color: ${o.type === 'chime' ? '#fab005' : '#fa5252'};">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 16px;">
                        <div style="font-size: 32px;">${icons[o.type] || 'ğŸ”Š'}</div>
                        <div style="width: 12px; height: 12px; border-radius: 50%; background: ${o.status === 'online' ? '#51cf66' : '#fa5252'};"></div>
                    </div>
                    <div style="font-size: 18px; font-weight: 700; margin-bottom: 4px;">${o.name}</div>
                    <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 12px;">
                        ${typeNames[o.type]} â€¢ ${o.protocol} â€¢ ${o.location}
                    </div>
                    
                    <div style="background: var(--bg-light); padding: 12px; border-radius: 8px; margin-bottom: 12px; font-size: 13px;">
                        ${o.volume ? `<div><strong>éŸ³é‡:</strong> ${o.volume} dB</div>` : ''}
                        ${o.brightness ? `<div><strong>äº®åº¦:</strong> ${o.brightness}%</div>` : ''}
                        <div><strong>è§¦å‘æ¨¡å¼:</strong> ${o.modes.join(', ')}</div>
                        <div><strong>æ¨¡å¼:</strong> ${o.pattern}</div>
                    </div>
                    
                    <div style="display: flex; gap: 8px;">
                        <button class="btn" style="flex: 1; font-size: 13px; padding: 8px;" onclick="testOutput('${o.id}')">ğŸ§ª æµ‹è¯•</button>
                        <button class="btn" style="flex: 1; font-size: 13px; padding: 8px;" onclick="editOutput('${o.id}')">âš™ï¸ ç¼–è¾‘</button>
                        <button class="btn btn-secondary" style="flex: 1; font-size: 13px; padding: 8px;" onclick="removeOutput('${o.id}')">ğŸ—‘ï¸ åˆ é™¤</button>
                    </div>
                </div>
            `).join('');
        }
        
        // æ¸²æŸ“æ‹“æ‰‘
        function renderTopology() {
            const canvas = document.getElementById('topologyCanvas');
            const icons = { camera: 'ğŸ“¹', door: 'ğŸšª', motion: 'ğŸ‘ï¸' };
            
            canvas.innerHTML = topology.map(ep => `
                <div class="entry-point">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div style="font-size: 36px;">${ep.icon}</div>
                            <div style="font-size: 20px; font-weight: 700;">${ep.name}</div>
                        </div>
                        <button class="btn btn-secondary" onclick="removeEntryPoint('${ep.id}')">ğŸ—‘ï¸ åˆ é™¤</button>
                    </div>
                    
                    <div style="font-weight: 700; margin-bottom: 12px; color: var(--text-secondary);">
                        ä¼ æ„Ÿå™¨è·¯å¾„ï¼ˆå®¤å¤– â†’ å®¤å†…ï¼‰ï¼š
                    </div>
                    
                    ${ep.sensors.map((s, i) => `
                        <div class="sensor-path">
                            <div style="font-size: 24px;">${icons[s.type] || 'ğŸ“¡'}</div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; font-size: 15px;">${s.name}</div>
                                <div style="font-size: 12px; color: var(--text-secondary);">${s.distance}</div>
                            </div>
                            ${i < ep.sensors.length - 1 ? '<div style="font-size: 24px; color: var(--text-secondary);">â†’</div>' : ''}
                        </div>
                    `).join('')}
                    
                    <button class="add-sensor-btn" onclick="addSensorToPath('${ep.id}')">
                        â• æ·»åŠ ä¼ æ„Ÿå™¨åˆ°è·¯å¾„
                    </button>
                </div>
            `).join('');
        }
        
        // äº‹ä»¶å¤„ç†
        function editSensor(id) {
            const sensor = sensors.find(s => s.id === id);
            alert('ç¼–è¾‘ä¼ æ„Ÿå™¨ï¼š' + sensor.name + '\n\nå½“å‰è®¾ç½®ï¼š\n- Zone: ' + sensor.zone + '\n- çŠ¶æ€: ' + sensor.status);
        }
        
        function removeSensor(id) {
            if (confirm('ç¡®å®šåˆ é™¤æ­¤ä¼ æ„Ÿå™¨ï¼Ÿè¿™ä¹Ÿä¼šå°†å…¶ä»æ‹“æ‰‘ä¸­ç§»é™¤ã€‚')) {
                sensors = sensors.filter(s => s.id !== id);
                renderSensors();
            }
        }
        
        function testOutput(id) {
            const output = outputs.find(o => o.id === id);
            alert('ğŸ§ª æµ‹è¯•æ¨¡å¼\n\næ­£åœ¨æµ‹è¯•ï¼š' + output.name + '\n\nå°†æ‰§è¡Œï¼š\n- éŸ³é‡: ' + (output.volume || 'N/A') + ' dB\n- æŒç»­æ—¶é—´: 3ç§’\n\nï¼ˆåœ¨å®é™…ç³»ç»Ÿä¸­ä¼šæ¿€æ´»è®¾å¤‡ï¼‰');
        }
        
        function editOutput(id) {
            const output = outputs.find(o => o.id === id);
            alert('ç¼–è¾‘è¾“å‡ºè®¾å¤‡ï¼š' + output.name + '\n\nå½“å‰è®¾ç½®ï¼š\n- ä½ç½®: ' + output.location + '\n- è§¦å‘æ¨¡å¼: ' + output.modes.join(', ') + '\n- éŸ³é‡/äº®åº¦å¯è°ƒèŠ‚');
        }
        
        function removeOutput(id) {
            if (confirm('ç¡®å®šåˆ é™¤æ­¤è¾“å‡ºè®¾å¤‡ï¼Ÿ')) {
                outputs = outputs.filter(o => o.id !== id);
                renderOutputs();
            }
        }
        
        function removeEntryPoint(id) {
            if (confirm('ç¡®å®šåˆ é™¤æ­¤å…¥å£ç‚¹åŠå…¶æ‰€æœ‰ä¼ æ„Ÿå™¨ï¼Ÿ')) {
                topology = topology.filter(ep => ep.id !== id);
                renderTopology();
            }
        }
        
        function addSensorToPath(epId) {
            const distance = prompt('è®¾ç½®ä¼ æ„Ÿå™¨è·ç¦»æ ‡ç­¾ï¼š\nä¾‹å¦‚ï¼š\n- "æ¥è¿‘ï¼ˆ5mï¼‰"\n- "é©¬ä¸Šï¼ˆ0mï¼‰"\n- "å…¥å£å¤„"\n- "å®¤å†…ï¼ˆ2mï¼‰"');
            if (distance) {
                const ep = topology.find(e => e.id === epId);
                ep.sensors.push({
                    name: 'æ–°ä¼ æ„Ÿå™¨',
                    type: 'camera',
                    distance: distance
                });
                renderTopology();
            }
        }
        
        // æŒ‰é’®äº‹ä»¶
        document.getElementById('addSensorBtn').onclick = function() {
            const name = prompt('ä¼ æ„Ÿå™¨åç§°ï¼š');
            if (name) {
                sensors.push({
                    id: 'sensor' + Date.now(),
                    name: name,
                    type: 'camera',
                    zone: 'Z-NEW',
                    status: 'online',
                    ip: '192.168.1.110'
                });
                renderSensors();
            }
        };
        
        document.getElementById('addOutputBtn').onclick = function() {
            const name = prompt('è¾“å‡ºè®¾å¤‡åç§°ï¼ˆå¦‚ï¼š"å‰é™¢è­¦ç¬›"ï¼‰ï¼š');
            if (name) {
                const type = prompt('è®¾å¤‡ç±»å‹ï¼š\n1 = è­¦ç¬› (siren)\n2 = é—ªå…‰ç¯ (strobe)\n3 = å£°å…‰æŠ¥è­¦å™¨ (siren_strobe)\n4 = æç¤ºéŸ³ (chime)\n\nè¯·è¾“å…¥æ•°å­— 1-4ï¼š');
                const typeMap = { '1': 'siren', '2': 'strobe', '3': 'siren_strobe', '4': 'chime' };
                const selectedType = typeMap[type] || 'siren_strobe';
                
                outputs.push({
                    id: 'output' + Date.now(),
                    name: name,
                    type: selectedType,
                    location: 'å¾…è®¾ç½®',
                    status: 'online',
                    protocol: 'Zigbee',
                    volume: selectedType !== 'strobe' ? 90 : undefined,
                    brightness: selectedType !== 'siren' ? 100 : undefined,
                    modes: ['PENDING', 'TRIGGERED'],
                    pattern: selectedType === 'siren' ? 'continuous' : 'flash_fast'
                });
                renderOutputs();
            }
        };
        
        document.getElementById('addEntryPointBtn').onclick = function() {
            const name = prompt('å…¥å£ç‚¹åç§°ï¼ˆä¾‹å¦‚ï¼š"EP-GARAGE"ã€"EP-WINDOW-FRONT"ï¼‰ï¼š');
            if (name) {
                topology.push({
                    id: 'ep' + Date.now(),
                    name: name,
                    icon: 'ğŸšª',
                    sensors: []
                });
                renderTopology();
            }
        };
        
        // Tabåˆ‡æ¢
        document.querySelectorAll('.tab').forEach((tab, index) => {
            tab.onclick = function() {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                tab.classList.add('active');
                document.querySelectorAll('.page')[index].classList.add('active');
            };
        });
        
        // å‚æ•°æ»‘å—åŒæ­¥
        const params = [
            { slider: 'tConfirmSlider', value: 'tConfirmValue' },
            { slider: 'loiterSlider', value: 'loiterValue' },
            { slider: 'confirmSlider', value: 'confirmValue' },
            { slider: 'signalMinSlider', value: 'signalMinValue' },
            { slider: 'pathWeightSlider', value: 'pathWeightValue' },
            { slider: 'dualCameraSlider', value: 'dualCameraValue' }
        ];
        
        params.forEach(p => {
            const slider = document.getElementById(p.slider);
            const input = document.getElementById(p.value);
            slider.oninput = function() { input.value = this.value; };
            input.oninput = function() { slider.value = this.value; };
        });
        
        // åˆå§‹åŒ–
        renderSensors();
        renderOutputs();
        renderTopology();
    </script>
</body>
</html>
